<div class="hero">
  <h2>Your Recipe Collection</h2>
  <p>Browse and manage your saved recipes</p>

  <div style="margin-top: 2rem;">
    <button onclick="window.location.href='/recipes/create'" style="margin-right: 1rem;">
      + Add New Recipe
    </button>
    <button onclick="loadRecipes()" style="background: linear-gradient(135deg, #2c3e50, #34495e);">
      Refresh List
    </button>
  </div>

  <div id="recipeList" class="results-grid"></div>
</div>

<script>
  async function loadRecipes() {
    const recipeList = document.getElementById('recipeList');
    recipeList.innerHTML = '<p class="loading">Loading recipes...</p>';

    try {
      const response = await fetch('/api/recipes');
      if (!response.ok) {
        throw new Error('Failed to load recipes');
      }

      const recipes = await response.json();

      if (recipes.length === 0) {
        recipeList.innerHTML = `
          <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
            <h3 style="color: #666; margin-bottom: 1rem;">No recipes found</h3>
            <p style="color: #999;">Start by adding your first recipe!</p>
          </div>
        `;
        return;
      }

      recipeList.innerHTML = recipes.map(recipe => `
        <div class="recipe-card">
          <h3>${recipe.name}</h3>
          <p><strong>Category:</strong> ${recipe.category || 'Uncategorized'}</p>
          <p><strong>Rating:</strong> ${recipe.rating || 'Not rated'}</p>
          <div style="margin-top: 1rem; display: flex; gap: 0.5rem; justify-content: center;">
            <button onclick="editRecipe(${recipe.id})" style="padding: 0.5rem 1rem; font-size: 0.9rem;">
              Edit
            </button>
            <button onclick="deleteRecipe(${recipe.id})" style="padding: 0.5rem 1rem; font-size: 0.9rem; background: linear-gradient(135deg, #e74c3c, #c0392b);">
              Delete
            </button>
          </div>
        </div>
      `).join('');
    } catch (error) {
      recipeList.innerHTML = `
        <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
          <h3 style="color: #e74c3c;">Error loading recipes</h3>
          <p style="color: #666;">${error.message}</p>
        </div>
      `;
    }
  }

  function editRecipe(id) {
    window.location.href = `/recipes/edit/${id}`;
  }

  async function deleteRecipe(id) {
    if (!confirm('Are you sure you want to delete this recipe?')) {
      return;
    }

    try {
      const response = await fetch(`/api/recipes/${id}`, {
        method: 'DELETE'
      });

      if (response.ok) {
        loadRecipes();
      } else {
        alert('Failed to delete recipe');
      }
    } catch (error) {
      alert('Error deleting recipe: ' + error.message);
    }
  }

  // Load recipes when page loads
  loadRecipes();
</script>
